<html>

<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/css/bootstrap.min.css" integrity="sha384-SI27wrMjH3ZZ89r4o+fGIJtnzkAnFs3E4qz9DIYioCQ5l9Rd/7UAa8DHcaL8jkWt" crossorigin="anonymous">
    <title>Test</title>
    <style>
        .avatar {
            height: 30px;
            width: 30px;
            overflow:hidden;
        }
        .avatar img {
            width:100%;
            height:100%;
        }

        .test {
            height: fit-content;
        }

        /* Ensure the size of the image fit the container perfectly */
        img {
            display: block;

        /* This rule is very important, please don't ignore this */
            max-width: 100%;
        }
    </style>
</head>

<body>
    <nav class="navbar bg-light navbar-expand-lg sticky-top justify-content-md-around">

        <ul class="nav">
            <li class="nav-item">
                <a class="navbar-brand" href="#">Navbar</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="#">Active</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
            </li>
        </ul>

        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-primary my-2 my-sm-0" type="submit">Search</button>
        </form>

        <ul class="nav">
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <img src="icons/icons/bell.svg" width="32" height="32" title="Notification">
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <img src="icons/icons/chat.svg" width="32" height="32" title="Message">
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <img src="icons/icons/bootstrap.svg" width="32" height="32" title="Bootstrap">
                </a>
            </li>
        </ul>
    </nav>
    <div class="card mb-3 mt-3 mr-auto ml-auto" style="max-width: 840px;">
        <div class="row no-gutters">
            <div class="col-md-4 align-self-center">
                <img src="img/flash.jpg" class="card-img" alt="...">
            </div>
            <div class="col-md-8">
                <div class="card-body">
                    <h5 class="card-title">Card title</h5>
                    <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
                    <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                </div>
            </div>
        </div>
    </div>
    <div class="card mb-3 mt-3 mr-auto ml-auto" style="max-width: 840px;">
        <div class="row no-gutters">
<!--            <div class="col-md-4 align-self-center">-->
<!--                <img src="img/flash.jpg" class="card-img" alt="...">-->
<!--            </div>-->
            <div class="col-md-12">
                <div class="card-body">
                    <h5 class="card-title">Card title</h5>
                    <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
                    <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                </div>
            </div>
        </div>
    </div>

    <div>
        <p>test img</p>
        <div class="avatar">
            <img src="img/tay.jpg" alt="...">
        </div>
    </div>
    <div>
        <p>test img</p>
        <div class="avatar">
            <img src="img/flash.jpg" alt="...">
        </div>
    </div>

    <div>
        <p>test img</p>
        <div class='test'>
            <img id='test-image' src="img/flash.jpg" alt="...">
        </div>
        <div >
            <img id='result-image'>
        </div>
        <button class="upload-result">Result</button>
    </div>

    <div class="result">

    </div>

    <!-- <h1>test</h1>
    <button type="button" class="btn btn-primary">
        Add
    </button>
    <div class="new-article">
        <div class="new-article-bg">
            <div class="new-article-container vertical-center">
                <div class="article-content">title</div>
                <div class="article-content">
                    <label class="article-input">
                        <input type="text" class="form-control" placeholder="Title" aria-label="Title">
                    </label>
                </div>
                <div class="article-content">content</div>
                <div class="article-content content">
                    <label class="article-input">
                        <input type="text" class="form-control" placeholder="Content" aria-label="Content">
                    </label>
                </div>
                <div class="article-content button-bar">
                    <button class="btn btn-primary">Publish</button>
                    <button class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>
    </div> -->

    <!-- <script>
        const log = console.log.bind(console)

        const body = document.querySelector("body")

        let addArticle = document.getElementById("add-article")
        addArticle.addEventListener("click", function() {
            let newArticle = `
            <div class="new-article">
                <div class="new-article-bg">
                    <div class="new-article-container vertical-center">
                        <div class="article-content">title</div>
                        <div class="article-content">
                            <label class="article-input">
                                <input type="text">
                            </label>
                        </div>
                        <div class="article-content">content</div>
                        <div class="article-content content">
                                <label class="article-input">
                                        <input type="text">
                                </label>
                        </div>
                        <div class="article-content button-bar">
                            <button class="new-article-submit">Publish</button>
                            <button class="new-article-cancel">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
            `
            body.insertAdjacentHTML('beforeend', newArticle)
        })

        body.addEventListener("click", function(event) {
            let t = event.target
            if (t.classList.contains("new-article-cancel") || t.classList.contains("new-article-bg")) {
                t.closest(".new-article").remove()
            }
        })
    </script> -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.0/js/bootstrap.min.js" integrity="sha384-3qaqj0lc6sV/qpzrc1N5DC6i1VRn/HyX4qdPaiEFbn54VjQBEU341pvjz7Dv3n6P" crossorigin="anonymous"></script>
    
    <!-- <link rel="stylesheet" href="node_modules/croppie/croppie.css" />
    <script src="node_modules/croppie/croppie.js"></script> -->
    <link  href="node_modules/cropperjs/dist/cropper.css" rel="stylesheet">
    <script src="node_modules/cropperjs/dist/cropper.js"></script>
    
    <script>
            // import 'cropperjs/dist/cropper.css';
           // import Cropper from 'cropperjs';
        //    const Cropper = require('cropperjs')

        const log = console.log.bind(console)
   
        const image = document.getElementById('test-image')
        // image.setAttribute('crossorigin', 'anonymous')
        console.log(image)
        const cropper = new Cropper(image, {
            checkCrossOrigin:false, // This is important
            aspectRatio: 1 / 1,
            crop(event) {
                console.log(event.detail.x);
                console.log(event.detail.y);
                console.log(event.detail.width);
                console.log(event.detail.height);
                console.log(event.detail.rotate);
                console.log(event.detail.scaleX);
                console.log(event.detail.scaleY);
            },
            viewMode: 3,
        });
        $('.upload-result').click(function() {
            let s = cropper.getCroppedCanvas()
            log(s)
            $('.result').html(s)
            // let resultImg = new Image()
            // let resultImg = convertCanvasToImage(s)
            // log(resultImg)
        })

        // todo canvas转图片
        // const convertCanvasToImage = function(canvas) {
        //     var image = new Image()
        //     image.setAttribute("crossOrigin", 'Anonymous')
        //     image.src = canvas.toDataURL("image/png")
        //     return image
        // }

            // console.log($('#test-image'))

            // $uploadCrop = $('#test-image').croppie({
            //     enableExif: true,
            //     viewport: {
            //         width: 200,
            //         height: 200,
            //         type: 'circle'
            //     },
            //     boundary: {
            //         width: 300,
            //         height: 300
            //     }
            // });
       </script>

</body>

</html>